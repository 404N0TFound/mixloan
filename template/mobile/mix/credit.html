

<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name = "viewport" content = "width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" >
    <meta content = "yes" name = "apple-mobile-web-app-capable" >
    <meta content = "black" name = "apple-mobile-web-app-status-bar-style" >
    <meta content = "telephone=no" name = "format-detection" >
    <meta content = "e-mail=no" name = "format-detection" / >
    <meta http - equiv = "Cache-Control" content = "no-cache, no-store, must-revalidate" / >
    <meta http - equiv = "Pragma" content = "no-cache" / >
    <meta http - equiv = "Expires" content = "0" / >
    <title>同盾数据查询</title>
    <link rel="stylesheet" type="text/css" href="../addons/xuan_mixloan/template/style/css/aui.css"/>
    <link rel="stylesheet" type="text/css" href="../addons/xuan_mixloan/template/style/css/intial.css" />
    <!-- pic -->
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/lmy.css">
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/index_new.css">
    <style>
        input:disabled{
            -webkit-text-fill-color: #666;
            -webkit-opacity: 1;
            color: #666;
        }
        .pic_one,.pic_two,.pic_tre{display: none;}
        .personfile li{height: 3rem;line-height: 3rem}
        .agent_foot a{height: 2.3rem;line-height: 2.3rem}
    </style>

    {template 'common/wxshare'}
</head>
<body class="bglightgray">
<script type="text/javascript" src="../addons/xuan_mixloan/template/style/mui/js/mui.min.js"></script>
<script type="text/javascript">
    function openNew(url){
        mui.openWindow({url:url});
    }
</script>
{if !is_weixin()}
<style type="text/css">
    .app_header{height: 80px;width: 100%;background: #ffffff}
    .app_header_back{text-align: center;color: white}
    .app_header_back{padding-top: 48px;padding-left: 4%;padding-right: 4%}
    .app_header_back img{float:left;width: 12px;}
    .app_header_back span{margin-top: 10px;font-size: 17px;color: #7e8181}
</style>
<div class="app_header">
    <div class="app_header_back">
        <img src="../addons/xuan_mixloan/template/style/images/left_1.png" onclick="mui.back()">
        <span>同盾数据查询</span>
    </div>
</div>
{/if}
<div class="agent-main">
    <div class="main-contain">
        <h5 class="file-title"></h5>
        <div class="personfile">
            <ul class="clearfix">
                <li class="border clearfix">
                    <div class="list-name">姓名</div>
                    <div class="input-wap"><input type="text" name="realname" id="realname" value="{$member['realname']}" placeholder="输入真实姓名" style="color: #666 !important;"></div>
                    <div class="pic pic_one"><img src="../addons/xuan_mixloan/template/style/picture/back.png"/></div>
                </li>
                <li class="border clearfix">
                    <div class="list-name">身份证</div>
                    <div class="input-wap"><input type="text" name="idcard" id="idcard"  placeholder="输入身份证" style="color: #666 !important;"></div>
                    <div class="pic pic_one"><img src="../addons/xuan_mixloan/template/style/picture/back.png"/></div>
                </li>
                <li class="border clearfix">
                    <div class="list-name">手机号</div>
                    <div class="input-wap"><input type="text" name="phone" id="phone" placeholder="输入手机号" style="color: #666 !important;"></div>
                    <div class="pic pic_one"><img src="../addons/xuan_mixloan/template/style/picture/back.png"/></div>
                </li>
                <li class="border clearfix">
                    <div class="list-name">邮箱</div>
                    <div class="input-wap"><input type="text" name="email" id="email"  placeholder="输入邮箱" style="color: #666 !important;"></div>
                    <div class="pic pic_one"><img src="../addons/xuan_mixloan/template/style/picture/back.png"/></div>
                </li>
            </ul>
        </div>

    </div>
    <div class="agent_foot">
        <a href="javascript:;"  id="upSubmit">提交</a>
    </div>
</div>
<script type="text/javascript" src="../addons/xuan_mixloan/template/style/js/jquery.min.js"></script>
<script type="text/javascript" src="../addons/xuan_mixloan/template/style/js/layer.js"></script>

<!-- js -->
<script type="text/javascript">
    // 恢复点击事件
    function click(){
        $("#upSubmit").bind("click",function(){
            upSubmit();
        });
    }
    $('#upSubmit').click(function(){
        upSubmit();
    })
    function dataTransform(res){
        var ret="";
        if(res==null||res==undefined){
            ret="";
        }else{
            ret=res;
        }
        return ret;
    }
    function upSubmit() {
        $("#upSubmit").unbind('click');
        var email=$("input[name='email']").val();  //微信号
        var realname=$("input[name='realname']").val();  //姓名
        var phone=$("input[name='phone']").val();   //手机号
        var idcard=$("input[name='idcard']").val();   //身份证

        if (realname == '输入真实姓名' || realname == '') {
            document.getElementById('realname').focus();
            layer.tips('请输入真实姓名', '#realname', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }
        if (email == '') {
            document.getElementById('email').focus();
            layer.tips('请输入邮箱', '#email', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }
        if (phone == '输入手机号' || phone == '') {
            document.getElementById('phone').focus();
            layer.tips('请输入联系人手机号', '#phone', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }
        if (!(/^1[3|4|5|7|8][0-9]\d{8}$/.test(phone))) {
            document.getElementById('phone').focus();
            $("input[name='phone']").attr("disabled",false);
            $('.pic_two').show();
            $("input[name='phone']").attr("disabled",false);
            layer.tips('请输入正确手机号', '#phone', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }
        if (idcard == '输入身份证号' || idcard == '') {
            document.getElementById('idcard').focus();
            layer.tips('请输入身份证号', '#idcard', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }

        if (!(/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/.test(idcard))) {
            document.getElementById('idcard').focus();
            $("input[name='idcard']").attr("disabled",false);
            $('.pic_tre').show();
            layer.tips('请填写正确身份证号', '#idcard', {
                tips: [3, '#0195ff'],
                time: 1000
            });
            click();
            return false;
        }

        var imguploadimg=layer.load(2, {
            shade: [0.5,'#000']
        });
        var ajax = {};
        ajax.url = "{php echo $this->createMobileUrl('mix', array('op'=>'credit', 'post'=>1))}";
        ajax.type = "post";
        ajax.dataType="json";
        ajax.data = {'realname':dataTransform(realname),'phone':dataTransform(phone),'idcard':dataTransform(idcard),'email':dataTransform(email)};
        ajax.success = function (data) {
            //alert(data);
            layer.close(imguploadimg);
            if (data.code == 1) {
                layer.msg(data.msg, {
                    time: 2000 //2秒关闭（如果不配置，默认是3秒）
                }, function(){
                   openNew(data.data.url);
                });
            }
            else {
                layer.msg(data.msg);
                click();
                return false;
            }

        }
        $.ajax(ajax);
    }

</script>

</body>
</html>