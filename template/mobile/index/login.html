<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta  content="e-mail=no" name="format-detection"/>
    <title>{$config['title']}登陆</title>
    <script src="../addons/xuan_mixloan/template/style/js//jquery_3.js"></script>
    <script type="text/javascript" src="../addons/xuan_mixloan/template/style/js/layer_3.js"></script>
    <script type="text/javascript" src="../addons/xuan_mixloan/template/style/mui/js/mui.min.js"></script>
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/layer5_3.css" id="layui_layer_skinlayercss">
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/swiper.min_3.css">
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/main_5.css">
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/base_3.css">
    <link rel="stylesheet" href="../addons/xuan_mixloan/template/style/css/new_base_5.css">
    <style type="text/css">
        html,body{background-color: #fff!important;min-height: 100%;background: url('../addons/xuan_mixloan/template/style/images/applybg_3.png') #f3f3f3 bottom center;background-repeat: no-repeat;background-size: 100%;}
        /*header*/
        div.header{width: 63%;margin: 0 auto; padding-top:55px;padding-bottom: 35px;}
        div.header ul{display: flex;overflow: hidden;}
        div.header ul li{width: 33.3%;text-align: center;float: left;}
        div.header ul li img{vertical-align: middle;}
        div.header ul li.link img{width:38%;max-height: 100%;padding-top:40%;margin-left: 10%;}
        div.header ul li.head img{width: 100%;max-width: 100%;display: block;border-radius: 100%;}
        div.header ul li.model_phone img{width: 73%;max-width: 100%;}
        /*contain*/
        div.fill_info{padding-top: 15%;}
        div.fill_info ul{border-radius: 30px!important; margin:0 auto;}
        div.fill_info ul li{position: relative; /*background-color: #fff;*/padding:25px 5px 10px 25px;border-radius: 3px;border-bottom: 1px solid #e5e5e5;overflow: hidden;}
        div.fill_info ul li span{display: inline-block;width:50px;color: #777777;line-height: 25px;}
        div.fill_info ul li label{float: left; display: inline-block;height: 25px;line-height: 25px;box-sizing: border-box;}
        div.fill_info ul li label img{display: inline-block;vertical-align: middle; width: 18px;margin:-2px 20px 0 0;}
        div.fill_info ul li input{float: left;width:80%;border:none;outline: none;height: 25px; line-height: 25px;font-size: 16px;box-sizing: border-box;-webkit-tap-highlight-color:rgba(255,255,255,0);}
        div.fill_info ul li a.validnum{position: absolute;bottom:10px; right:5%; border-radius:20px; text-align: center;color: #fff;padding:0.4rem 10px;background: #0195ff;min-width: 35px;}
        div.fill_info>p.regbg{position: fixed;width: 90%;bottom: 3%;left: 5%;}
        div.fill_info>p.regbg img{width: 100%;display: block;}
        div.fill_info ul li.re_psw span{width:70px;}
        div.submit_btn{text-align: center;}
        div.fill_info a.to_buy{display: inline-block; width:84%;margin:0px auto; margin-top:50px; height:42px;border-radius: 5px; font-size: 17px; text-align: center;line-height: 42px;color: #fff;background-color: #0195ff;letter-spacing: 5px;}
        div.fill_info>img{width: 22%;display: block;margin: 0 auto 5% auto;}
        div.regProtocol{text-indent: 6%;padding-top: 10px;}
        div.regProtocol label{display: inline;margin-right: 5px;}
        div.regProtocol label img{width: 15px;height: 15px;display: inline-block;vertical-align: middle;margin-top: -3px;}
        div.regProtocol span{color: #9a989b;font-style: 12px;display: inline;}
        div.regProtocol a{display: inline;color: #0194fc;font-style: 12px;}
        .login_app_wechat{width: 100%;display: inline-block;margin-top: 3rem;text-align: center;}
        .to_find,.to_register{    display: inline-block;width: 84%; margin: 0px auto;margin-top: 50px;height: 42px;border-radius: 5px;font-size: 17px;text-align: center; line-height: 42px; color: #fff; background-color: #0195ff; letter-spacing: 5px;margin-top: 1rem;}
    </style>
    {template 'common/wxshare'}
</head>
<script type="text/javascript">
    function openNew(url){
        mui.openWindow({url:url});
    }
</script>
<script type="text/javascript">
    if (typeof(plus) == 'undefined') {
        openNew('http://juxinwangluo.xin/app/index.php?i=4&c=entry&op=exit&do=index&m=xuan_mixloan');
    }
</script>
{if !is_weixin()}
<style type="text/css">
    .app_header{height: 70px;width: 100%}
</style>
<script type="text/javascript">
    mui.plusReady(function() {
        plus.key.addEventListener('backbutton', function() {
            if (confirm('确认退出？')) {
                plus.runtime.quit();
            }
        }, false);
        var wv=plus.webview.currentWebview();
        // 关闭侧滑返回功能
        wv.setStyle({'popGesture':'none'});
    });
</script>
<div class="app_header">
</div>
{/if}
<body class="bgcolor">
<div class="fill_info">
    <img src="{php echo tomedia($config['logo']);}" />
    <ul>
        <li>
            <label><img src="../addons/xuan_mixloan/template/style/picture/phone_3.png" style="width: 16px;" /></label>
            <input type="tel" name="" id="phone" maxlength="11" placeholder="请输入您的手机号">
        </li>
        <li class="psw">
            <label><img src="../addons/xuan_mixloan/template/style/picture/pswd_3.png" /></label>
            <input type="password" name="" id="psw" onpaste="return false" ondragenter="return false"  onkeyup="this.value=check(this.value)" placeholder="请输入您的登录密码">
        </li>
    </ul>
    <div class="submit_btn">
        <a class="to_buy">登陆</a>
        <a class="to_register" onclick="openNew('{php echo $this->createMobileUrl('index', array('op'=>'register'))}')" >注册</a>
        <a class="to_find" onclick="openNew('{php echo $this->createMobileUrl('index', array('op'=>'find_pass'))}')" >找回密码</a>
    </div>
    <!-- <a class="login_app_wechat" href="{php echo $this->createMobileUrl('index', ['op'=>'wechat_login_app'])}">
        <img src="../addons/xuan_mixloan/template/style/mui/images/icon-weixin.png" style="width: 5rem">
    </a> -->
    <!-- <p class="regbg"><img src="../addons/xuan_mixloan/template/style/picture/regbg_3.png" /></p> -->
</div>

<script type="text/javascript" src=../addons/xuan_mixloan/template/style/js/jquery_3.js></script>
<script type="text/javascript" src=../addons/xuan_mixloan/template/style/js/swiper.min_3.js></script>
<script type="text/javascript" src=../addons/xuan_mixloan/template/style/js/common_3.js></script>
<script type="text/javascript">

    $(document).ready(function(){
        $("div.header ul li.head").find("img").load(function(){
            // 头像居中
            var ul_height=$("div.header").height();
            var header_h=$("div.header ul li.head").find("img").height();
            var margin_top=(ul_height-header_h)/2+"px";
            $("div.header ul li.head img").css("margin-top",margin_top);
            //验证码居中
            var li_h=$("div.fill_info ul li").innerHeight();
            var v_h=$("div.fill_info ul li a.validnum").height();
            var top=(li_h-v_h)/2+"px";
            $("div.fill_info ul li a.validnum").css("top",top);
        })
    })
    //密码中文限制
    function check(str){
        var temp=""
        for(var i=0;i<str.length;i++)
            if(str.charCodeAt(i)>0&&str.charCodeAt(i)<255)
                temp+=str.charAt(i)
        return temp
    }
    //提交
    $(".to_buy").click(function(){
        to_buy();
    })
    function to_buy(){
        // var name=$("#name").val();
        var phone=$("#phone").val();
        var validcode=$("#validcode").val();
        var psw=$("#psw").val();
        var psw_l=$("#psw").val().length;
        // if(name==""){
        // 	layer.msg("请输入姓名");
        // 	bind_click();
        // 	return false;
        // }
        if (phone == '请输入手机号码' || phone == '') {
            layer.msg('请输入手机号码');
            bind_click();
            return false;
        }else{
            if (!(/^1[3|4|5|7|8][0-9]\d{8}$/.test(phone))) {
                layer.msg('请输入正确的手机号');
                bind_click();
                return false;
            }
        }
        if(psw==""){
            layer.msg("请输入密码");
            bind_click();
            return false;
        }
        if(psw_l<6){
            layer.msg("密码不能少于6位");
            bind_click();
            return false;
        }
        $.post("{php echo $this->createMobileUrl('index', array('op'=>'login_ajax'))}",{"phone":phone,"pwd":psw},
            function(data){
                console.log(data);
                if(data.code==1){
                    layer.msg("提交成功，正在跳转...",function(){
                        mui.openWindow({url:data.data.url, id:'user_index',createNew:true});
                    });
                }else{
                    layer.msg(data.msg);
                    bind_click();
                    return false;
                }
            },'json')
    }
    function bind_click(){
        $(".to_buy").bind("click",function(){
            to_buy();
        });
    }
    //避免输入法影响样式
    $('input').on('focus',function(){
        window.onresize = function () {
            var h = $(window).height();
            var u = navigator.userAgent;
            if (u.indexOf('Android') > -1 || u.indexOf('Linux') > -1) {
                if(h <= window.screen.availHeight/2){
                    $('.regbg').hide();
                }else{
                    $('.regbg').show();
                }
            }
        }
    })
    mui.init({
        swipeBack:true, //启用右滑关闭功能,
        keyEventBind: {
            backbutton: false  //关闭back按键监听
        }
    });
</script>
</body>
</html>